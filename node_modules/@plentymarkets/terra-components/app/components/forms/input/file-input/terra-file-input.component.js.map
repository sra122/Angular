{"version":3,"sources":["app/components/forms/input/file-input/terra-file-input.component.ts"],"names":[],"mappings":"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","file":"terra-file-input.component.js","sourcesContent":["import {\n    Component,\n    forwardRef,\n    Input,\n    ViewChild\n} from '@angular/core';\nimport { TranslationService } from 'angular-l10n';\nimport { isNullOrUndefined } from 'util';\nimport { NG_VALUE_ACCESSOR } from '@angular/forms';\nimport { TerraInputComponent } from '../terra-input.component';\nimport { PathHelper } from '../../../../helpers/path.helper';\nimport { FileTypeHelper } from '../../../../helpers/fileType.helper';\nimport { TerraBaseStorageService } from '../../../file-browser/terra-base-storage.interface';\nimport { TerraFrontendStorageService } from '../../../file-browser/terra-frontend-storage.service';\nimport { TerraRegex } from '../../../../helpers/regex/terra-regex';\nimport { TerraStorageObject } from '../../../file-browser/model/terra-storage-object';\nimport { TerraOverlayComponent } from '../../../layouts/overlay/terra-overlay.component';\nimport { TerraOverlayButtonInterface } from '../../../layouts/overlay/data/terra-overlay-button.interface';\nimport { StringHelper } from '../../../../helpers/string.helper';\n\nlet nextId:number = 0;\n\n@Component({\n    selector:  'terra-file-input',\n    template:  require('./terra-file-input.component.html'),\n    styles:    [require('./terra-file-input.component.scss')],\n    providers: [\n        {\n            provide:     NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => TerraFileInputComponent),\n            multi:       true\n        }\n    ]\n})\nexport class TerraFileInputComponent extends TerraInputComponent\n{\n    @Input()\n    public inputShowPreview:boolean = false;\n\n    @Input()\n    public inputAllowedExtensions:Array<string> = [];\n\n    @Input()\n    public inputAllowFolders:boolean = true;\n\n    @Input()\n    public set inputStorageServices(services:Array<TerraBaseStorageService>)\n    {\n        this.storageServices = services;\n    }\n\n    public get inputStorageServices():Array<TerraBaseStorageService>\n    {\n        return this.storageServices || [this.frontendStorageService];\n    }\n\n    @ViewChild('overlay')\n    public overlay:TerraOverlayComponent;\n\n    @ViewChild('previewOverlay')\n    public previewOverlay:TerraOverlayComponent;\n\n    public primaryOverlayButton:TerraOverlayButtonInterface;\n    public secondaryOverlayButton:TerraOverlayButtonInterface;\n\n    protected id:string;\n    protected translationPrefix:string = 'terraFileInput';\n\n    private storageServices:Array<TerraBaseStorageService>;\n\n    constructor(private translation:TranslationService, private frontendStorageService:TerraFrontendStorageService)\n    {\n        super(TerraRegex.MIXED);\n\n        // generate the id of the input instance\n        this.id = `file-input_#${nextId++}`;\n    }\n\n    public onObjectSelected(selectedObject:TerraStorageObject):void\n    {\n        this.value = selectedObject.publicUrl;\n    }\n\n    public onPreviewClicked():void\n    {\n        if(this.isWebImage(this.value))\n        {\n            this.previewOverlay.showOverlay();\n        }\n    }\n\n    public showFileBrowser():void\n    {\n        this.overlay.showOverlay();\n    }\n\n    public getIconClass(filename:string):string\n    {\n        if(isNullOrUndefined(filename))\n        {\n            return '';\n        }\n\n        if(PathHelper.isDirectory(filename))\n        {\n            return 'icon-folder';\n        }\n        return FileTypeHelper.mapIconClass(filename);\n    }\n\n    public isWebImage(filename:string):boolean\n    {\n        return !StringHelper.isNullUndefinedOrEmpty(filename) && FileTypeHelper.isWebImage(filename);\n    }\n\n    public getFilename(path:string):string\n    {\n        if(isNullOrUndefined(path))\n        {\n            return '';\n        }\n        return PathHelper.basename(path);\n    }\n\n    public resetValue():void\n    {\n        this.value = '';\n    }\n}\n"]}